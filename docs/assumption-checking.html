<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Assumption checking | Introduction to Statistics</title>
<meta name="author" content="Philip T. Leftwich">
<meta name="description" content="After conducting a linear model analysis, we often find ourselves with results and inferences. However, before we can fully trust our analysis, it’s essential to check whether the underlying...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 9 Assumption checking | Introduction to Statistics">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ueabio.github.io/physalia-intro-stats-2023/assumption-checking.html">
<meta property="og:image" content="https://ueabio.github.io/physalia-intro-stats-2023/images/logos/twitter_card.png">
<meta property="og:description" content="After conducting a linear model analysis, we often find ourselves with results and inferences. However, before we can fully trust our analysis, it’s essential to check whether the underlying...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Assumption checking | Introduction to Statistics">
<meta name="twitter:description" content="After conducting a linear model analysis, we often find ourselves with results and inferences. However, before we can fully trust our analysis, it’s essential to check whether the underlying...">
<meta name="twitter:image" content="https://ueabio.github.io/physalia-intro-stats-2023/images/logos/twitter_card.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/font-awesome-5.13.0/js/script.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.10/grViz.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script language="javascript"> 
        function toggle(id) {
            var ele = document.getElementById("toggleText" + id);
            var text = document.getElementById("displayText" + id);
            var buttonText = text.innerHTML.replace("Show ", "");
            buttonText = buttonText.replace("Hide ", "");
            if(ele.style.display == "block") {
                ele.style.display = "none";
                text.innerHTML = "Show " + buttonText;
            } else {
                ele.style.display = "block";
                text.innerHTML = "Hide " + buttonText;
            }
        } 
    </script><script language="javascript">
        function openCode(evt, codeName, id) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent" + id);
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks" + id);
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(codeName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script><script language="javascript">
        function hide(id){
            document.getElementById(id).style.display = "none";
        }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A guide for Biologists and Ecologists">Introduction to Statistics</a>:
        <small class="text-muted">A guide for Biologists and Ecologists</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li class="book-part">Exploring Data</li>
<li><a class="" href="loading-data.html"><span class="header-section-number">1</span> Loading data</a></li>
<li><a class="" href="data-wrangling-part-one.html"><span class="header-section-number">2</span> Data wrangling part one</a></li>
<li><a class="" href="data-wrangling-part-two.html"><span class="header-section-number">3</span> Data wrangling part two</a></li>
<li><a class="" href="data-visualisation-with-ggplot2.html"><span class="header-section-number">4</span> Data visualisation with ggplot2</a></li>
<li class="book-part">Descriptive Statistics</li>
<li><a class="" href="data-quality.html"><span class="header-section-number">5</span> Data Quality</a></li>
<li><a class="" href="data-insights.html"><span class="header-section-number">6</span> Data insights</a></li>
<li class="book-part">Linear models</li>
<li><a class="" href="introduction-to-statistics.html"><span class="header-section-number">7</span> Introduction to statistics</a></li>
<li><a class="" href="introduction-to-linear-models.html"><span class="header-section-number">8</span> Introduction to Linear Models</a></li>
<li><a class="active" href="assumption-checking.html"><span class="header-section-number">9</span> Assumption checking</a></li>
<li><a class="" href="testing.html"><span class="header-section-number">10</span> Testing</a></li>
<li><a class="" href="paired-designs.html"><span class="header-section-number">11</span> Paired designs</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">13</span> ANOVA</a></li>
<li class="book-part">Multiple regression</li>
<li><a class="" href="multi-factor-anova.html"><span class="header-section-number">14</span> Multi factor ANOVA</a></li>
<li><a class="" href="complex-models.html"><span class="header-section-number">15</span> Complex models</a></li>
<li class="book-part">Generalized Linear Models</li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">16</span> Generalized Linear Models</a></li>
<li><a class="" href="logistic-regression-for-binary-data.html"><span class="header-section-number">17</span> Logistic regression (for binary data)</a></li>
<li><a class="" href="poisson-regression-for-count-data-or-rate-data.html"><span class="header-section-number">18</span> Poisson regression (for count data or rate data)</a></li>
<li class="book-part">Mixed Models</li>
<li><a class="" href="foundations-of-mixed-modelling.html"><span class="header-section-number">19</span> Foundations of Mixed Modelling</a></li>
<li><a class="" href="worked-example-1---dolphins.html"><span class="header-section-number">20</span> Worked Example 1 - Dolphins</a></li>
<li><a class="" href="multiple-random-effects.html"><span class="header-section-number">21</span> Multiple random effects</a></li>
<li><a class="" href="worked-example-2---nested-design.html"><span class="header-section-number">22</span> Worked Example 2 - Nested design</a></li>
<li><a class="" href="types-of-random-effects.html"><span class="header-section-number">23</span> Types of Random Effects</a></li>
<li><a class="" href="worked-example-3---sleep-study.html"><span class="header-section-number">24</span> Worked Example 3 - Sleep study</a></li>
<li><a class="" href="reporting-mixed-model-results.html"><span class="header-section-number">25</span> Reporting Mixed Model Results</a></li>
<li><a class="" href="summary-11.html"><span class="header-section-number">26</span> Summary</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/UEABIO/physalia-intro-stats-2023">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="assumption-checking" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Assumption checking<a class="anchor" aria-label="anchor" href="#assumption-checking"><i class="fas fa-link"></i></a>
</h1>
<p>After conducting a linear model analysis, we often find ourselves with results and inferences. However, before we can fully trust our analysis, it’s essential to check whether the underlying assumptions of the model are adequately met. In this chapter, we will focus on two critical assumptions: the normality of residuals and the homogeneity of variance. We will also discuss the impact of outliers on our model and the formal tests available for these assumptions.</p>
<div id="assumption-1-normality-of-residuals" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Assumption 1: Normality of Residuals<a class="anchor" aria-label="anchor" href="#assumption-1-normality-of-residuals"><i class="fas fa-link"></i></a>
</h2>
<div id="understanding-residuals" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Understanding Residuals<a class="anchor" aria-label="anchor" href="#understanding-residuals"><i class="fas fa-link"></i></a>
</h3>
<p>Residuals are the differences between observed values and the fitted values produced by the model. In our case, this involves analyzing plant heights against treatment means. The normality of residuals is crucial because the linear model relies on this assumption to compute standard errors, which in turn affects confidence intervals and hypothesis testing.</p>
</div>
<div id="graphical-checks-for-normality" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Graphical Checks for Normality<a class="anchor" aria-label="anchor" href="#graphical-checks-for-normality"><i class="fas fa-link"></i></a>
</h3>
<p>To visually assess the normality of residuals, we can utilize various plotting functions in R. Two effective methods are:</p>
<p>Quantile-Quantile (QQ) Plot: This plot compares the distribution of residuals to a theoretical normal distribution. If the residuals follow a normal distribution, they should approximately align along a diagonal line.</p>
<div class="tab">
<button class="tablinksunnamed-chunk-24 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-24', 'unnamed-chunk-24');">
Base R
</button>
<button class="tablinksunnamed-chunk-24" onclick="javascript:openCode(event, 'option2unnamed-chunk-24', 'unnamed-chunk-24');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-24" class="tabcontentunnamed-chunk-24">
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lsmodel1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="option2unnamed-chunk-24" class="tabcontentunnamed-chunk-24">
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"normality"</span>,<span class="st">"qq"</span><span class="op">)</span>,</span>
<span>                         detrend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<script> javascript:hide('option2unnamed-chunk-24') </script>
</div>
<div id="formal-test-of-normality" class="section level3" number="9.1.3">
<h3>
<span class="header-section-number">9.1.3</span> Formal test of Normality<a class="anchor" aria-label="anchor" href="#formal-test-of-normality"><i class="fas fa-link"></i></a>
</h3>
<div class="tab">
<button class="tablinksunnamed-chunk-25 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-25', 'unnamed-chunk-25');">
Base R
</button>
<button class="tablinksunnamed-chunk-25" onclick="javascript:openCode(event, 'option2unnamed-chunk-25', 'unnamed-chunk-25');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-25" class="tabcontentunnamed-chunk-25">
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(lsmodel1)
## W = 0.83089, p-value = 0.0002531</code></pre>
</div>
<div id="option2unnamed-chunk-25" class="tabcontentunnamed-chunk-25">
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html">check_normality</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Non-normality of residuals detected (p &lt; .001).</code></pre>
</div>
<script> javascript:hide('option2unnamed-chunk-25') </script>
</div>
</div>
<div id="assumption-2-homogeneity-of-variance" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Assumption 2: Homogeneity of Variance<a class="anchor" aria-label="anchor" href="#assumption-2-homogeneity-of-variance"><i class="fas fa-link"></i></a>
</h2>
<div id="assessing-equal-variance" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Assessing Equal Variance<a class="anchor" aria-label="anchor" href="#assessing-equal-variance"><i class="fas fa-link"></i></a>
</h3>
<p>The assumption of homogeneity of variance (or homoscedasticity) states that the residual variance should be constant across all levels of the independent variable(s). This is important because linear models often pool variance across groups to make inferences.</p>
</div>
<div id="graphical-checks-for-homogeneity" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Graphical Checks for Homogeneity<a class="anchor" aria-label="anchor" href="#graphical-checks-for-homogeneity"><i class="fas fa-link"></i></a>
</h3>
<p>To assess this assumption, we can plot the residuals against the fitted values:</p>
<div class="tab">
<button class="tablinksunnamed-chunk-26 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-26', 'unnamed-chunk-26');">
Base R
</button>
<button class="tablinksunnamed-chunk-26" onclick="javascript:openCode(event, 'option2unnamed-chunk-26', 'unnamed-chunk-26');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-26" class="tabcontentunnamed-chunk-26">
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lsmodel1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-40-1.png" width="100%" style="display: block; margin: auto;"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-40-2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="option2unnamed-chunk-26" class="tabcontentunnamed-chunk-26">
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"homogeneity"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<script> javascript:hide('option2unnamed-chunk-26') </script>
</div>
<div id="formal-tests-for-homogeneity-of-variance" class="section level3" number="9.2.3">
<h3>
<span class="header-section-number">9.2.3</span> Formal Tests for Homogeneity of Variance<a class="anchor" aria-label="anchor" href="#formal-tests-for-homogeneity-of-variance"><i class="fas fa-link"></i></a>
</h3>
<p>To formally test for homogeneity of variance, we can use:</p>
<p>Breusch-Pagan Test: This test evaluates whether the variance of residuals is constant.</p>
<div class="tab">
<button class="tablinksunnamed-chunk-27 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-27', 'unnamed-chunk-27');">
Base R
</button>
<button class="tablinksunnamed-chunk-27" onclick="javascript:openCode(event, 'option2unnamed-chunk-27', 'unnamed-chunk-27');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-27" class="tabcontentunnamed-chunk-27">
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">lsmodel1</span>, varformula <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted.values</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span>, studentize <span class="op">=</span> <span class="cn">F</span> <span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Breusch-Pagan test
## 
## data:  lsmodel1
## BP = 3.9496, df = 1, p-value = 0.04688</code></pre>
</div>
<div id="option2unnamed-chunk-27" class="tabcontentunnamed-chunk-27">
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_heteroscedasticity.html">check_heteroscedasticity</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Heteroscedasticity (non-constant error variance) detected (p = 0.047).</code></pre>
</div>
<script> javascript:hide('option2unnamed-chunk-27') </script>
</div>
</div>
<div id="assumption-3-linearity" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Assumption 3: Linearity<a class="anchor" aria-label="anchor" href="#assumption-3-linearity"><i class="fas fa-link"></i></a>
</h2>
<p>Linear regression assumes a linear relationship between the predictor(s) and the response variable. If this assumption is violated, the model may produce biased or inaccurate predictions.</p>
<div id="graphical-checks-for-linearity" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Graphical checks for linearity<a class="anchor" aria-label="anchor" href="#graphical-checks-for-linearity"><i class="fas fa-link"></i></a>
</h3>
<p>To assess this assumption, we can plot the residuals against the fitted values:</p>
<div class="tab">
<button class="tablinksunnamed-chunk-28 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-28', 'unnamed-chunk-28');">
Base R
</button>
<button class="tablinksunnamed-chunk-28" onclick="javascript:openCode(event, 'option2unnamed-chunk-28', 'unnamed-chunk-28');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-28" class="tabcontentunnamed-chunk-28">
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lsmodel1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-36-2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="option2unnamed-chunk-28" class="tabcontentunnamed-chunk-28">
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"linearity"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<script> javascript:hide('option2unnamed-chunk-28') </script><p>Checking for linearity can be difficult when we only have two groups in our model:</p>
<ul>
<li><p><strong>Limited Data Points</strong>: With only two levels, you have a limited number of data points, which may not adequately capture the underlying relationship. This makes it hard to assess linearity visually or statistically.</p></li>
<li><p><strong>No Intermediate Values</strong>: A binary predictor means there are no intermediate values to examine. This limits the ability to see a continuous trend or relationship.</p></li>
</ul>
</div>
</div>
<div id="outliers-and-their-impact" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Outliers and Their Impact<a class="anchor" aria-label="anchor" href="#outliers-and-their-impact"><i class="fas fa-link"></i></a>
</h2>
<p>Outliers can significantly affect the estimates of a model, influencing both residuals and overall model fit. Therefore, it’s essential to assess the presence and impact of outliers on our analysis.</p>
<div id="identifying-outliers" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> Identifying Outliers<a class="anchor" aria-label="anchor" href="#identifying-outliers"><i class="fas fa-link"></i></a>
</h3>
<p>To identify outliers, we can employ Cook's Distance, which measures the influence of each data point on the model fit. Large values of Cook's Distance suggest that a point may be having an outsized effect.</p>
<div class="tab">
<button class="tablinksunnamed-chunk-29 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-29', 'unnamed-chunk-29');">
Base R
</button>
<button class="tablinksunnamed-chunk-29" onclick="javascript:openCode(event, 'option2unnamed-chunk-29', 'unnamed-chunk-29');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-29" class="tabcontentunnamed-chunk-29">
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lsmodel1</span>, which<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-38-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="option2unnamed-chunk-29" class="tabcontentunnamed-chunk-29">
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outliers"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="13-Introduction-to-linear-models_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<script> javascript:hide('option2unnamed-chunk-29') </script>
</div>
<div id="formal-tests-for-outliers" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> Formal Tests for Outliers<a class="anchor" aria-label="anchor" href="#formal-tests-for-outliers"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_outliers.html">check_outliers</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span></span></code></pre></div>
<pre><code>## OK: No outliers detected.
## - Based on the following method and threshold: cook (0.5).
## - For variable: (Whole model)</code></pre>
</div>
</div>
<div id="multicollinearity-1" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Multicollinearity<a class="anchor" aria-label="anchor" href="#multicollinearity-1"><i class="fas fa-link"></i></a>
</h2>
<p>Check: Assess whether predictors are highly correlated with each other, which can affect the stability of coefficient estimates. In this model we only have a single predictor, so this test is not required - we will revisit this with more complex models later.</p>
<div class="tab">
<button class="tablinksunnamed-chunk-31 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-31', 'unnamed-chunk-31');">
Base R
</button>
<button class="tablinksunnamed-chunk-31" onclick="javascript:openCode(event, 'option2unnamed-chunk-31', 'unnamed-chunk-31');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-31" class="tabcontentunnamed-chunk-31">
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="option2unnamed-chunk-31" class="tabcontentunnamed-chunk-31">
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, check<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vif"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<script> javascript:hide('option2unnamed-chunk-31') </script>
</div>
<div id="summary-3" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Summary<a class="anchor" aria-label="anchor" href="#summary-3"><i class="fas fa-link"></i></a>
</h2>
<p>So what can we determine from this analysis? Our model is not perfect, however it is reasonably good. Many of the statistical violations are likely because of the small sample size - and collecting more data might be a good idea.</p>
<p>Linear models are powerful tools for analyzing relationships between variables, but their validity hinges on several key assumptions. Checking these assumptions is crucial to ensure the reliability and interpretability of the model's results.</p>
<p>By systematically checking these assumptions, researchers can ensure that their linear models are robust, reliable, and capable of providing meaningful insights into the relationships between variables. Ignoring these checks can lead to flawed analyses and misguided conclusions, underscoring the necessity of thorough model evaluation.</p>
<p>In this chapter, we covered essential steps for checking linear model assumptions, including:</p>
<ul>
<li><p>Assessing the normality of residuals through QQ plots and formal tests (e.g., Shapiro-Wilk).</p></li>
<li><p>Evaluating homogeneity of variance using residual plots and formal tests (e.g., Breusch-Pagan).</p></li>
<li><p>Testing for model linearity</p></li>
<li><p>Identifying outliers through Cook's Distance.</p></li>
</ul>
<p>We can check all our model assumptions at once, as well as looking at individual plots as shown above.</p>
<div class="tab">
<button class="tablinksunnamed-chunk-32 active" onclick="javascript:openCode(event, 'option1unnamed-chunk-32', 'unnamed-chunk-32');">
Base R
</button>
<button class="tablinksunnamed-chunk-32" onclick="javascript:openCode(event, 'option2unnamed-chunk-32', 'unnamed-chunk-32');">
<tt>tidyverse</tt>
</button>
</div>
<div id="option1unnamed-chunk-32" class="tabcontentunnamed-chunk-32">
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lsmodel1</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="option2unnamed-chunk-32" class="tabcontentunnamed-chunk-32">
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">performance</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">lsmodel1</span>, detrend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
<script> javascript:hide('option2unnamed-chunk-32') </script><p>While graphical checks provide a valuable first step, complementing them with formal tests strengthens our analysis.</p>
<p>Conversely when sample sizes are very low or very large we can often see deviations from normality through formal tests which we might decide to tolerate based on on the graphical checks of model fit.</p>
<p>By thoroughly checking these assumptions, we can ensure the reliability of our linear model analysis and make informed decisions based on the results obtained.</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    license
  );
});
</script><div class="chapter-nav">
<div class="prev"><a href="introduction-to-linear-models.html"><span class="header-section-number">8</span> Introduction to Linear Models</a></div>
<div class="next"><a href="testing.html"><span class="header-section-number">10</span> Testing</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#assumption-checking"><span class="header-section-number">9</span> Assumption checking</a></li>
<li>
<a class="nav-link" href="#assumption-1-normality-of-residuals"><span class="header-section-number">9.1</span> Assumption 1: Normality of Residuals</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#understanding-residuals"><span class="header-section-number">9.1.1</span> Understanding Residuals</a></li>
<li><a class="nav-link" href="#graphical-checks-for-normality"><span class="header-section-number">9.1.2</span> Graphical Checks for Normality</a></li>
<li><a class="nav-link" href="#formal-test-of-normality"><span class="header-section-number">9.1.3</span> Formal test of Normality</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#assumption-2-homogeneity-of-variance"><span class="header-section-number">9.2</span> Assumption 2: Homogeneity of Variance</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assessing-equal-variance"><span class="header-section-number">9.2.1</span> Assessing Equal Variance</a></li>
<li><a class="nav-link" href="#graphical-checks-for-homogeneity"><span class="header-section-number">9.2.2</span> Graphical Checks for Homogeneity</a></li>
<li><a class="nav-link" href="#formal-tests-for-homogeneity-of-variance"><span class="header-section-number">9.2.3</span> Formal Tests for Homogeneity of Variance</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#assumption-3-linearity"><span class="header-section-number">9.3</span> Assumption 3: Linearity</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#graphical-checks-for-linearity"><span class="header-section-number">9.3.1</span> Graphical checks for linearity</a></li></ul>
</li>
<li>
<a class="nav-link" href="#outliers-and-their-impact"><span class="header-section-number">9.4</span> Outliers and Their Impact</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identifying-outliers"><span class="header-section-number">9.4.1</span> Identifying Outliers</a></li>
<li><a class="nav-link" href="#formal-tests-for-outliers"><span class="header-section-number">9.4.2</span> Formal Tests for Outliers</a></li>
</ul>
</li>
<li><a class="nav-link" href="#multicollinearity-1"><span class="header-section-number">9.5</span> Multicollinearity</a></li>
<li><a class="nav-link" href="#summary-3"><span class="header-section-number">9.6</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/UEABIO/physalia-intro-stats-2023/blob/main/book/13-Introduction-to-linear-models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/UEABIO/physalia-intro-stats-2023/edit/main/book/13-Introduction-to-linear-models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Statistics</strong>: A guide for Biologists and Ecologists" was written by Philip T. Leftwich. It was last built on 2024-07-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
